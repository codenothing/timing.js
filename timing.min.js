/**
 * Timing.js 0.1.0pre
 * April 28, 2011
 * Corey Hart @ http://www.codenothing.com
 */
(function(u){function x(b){if(m){i.body.removeChild(m);i.removeEventListener("click",x,false);i.removeEventListener("keyup",L,false);M(b)}}function L(b){b.keyCode==27&&x(b)}function M(b){f=false;b.preventDefault();b.stopPropagation()}if(!u.performance||!u.performance.timing)return alert("This browser doesn't support the timing module.");var F=u.performance,a=F.timing,p=F.navigation,v=a.navigationStart||a.fetchStart,s=[["navigationStart","Timestamp immediately after prompting to unload the previous document"],
["redirectStart","Timestamp immediately before the start of the fetch that initiates the redirect"],["redirectEnd","Timestamp immediately after receiving the last byte of the response of the last redirect"],["fetchStart","Timestamp immediately before checking application cache or fetching the resource"],["domainLookupStart","Timestamp immediately before DNS lookup of current document"],["domainLookupEnd","Timestamp immediately after DNS lookup of current document"],["connectStart","Timestamp immediately before establishing a connection to the server for document retrieval"],
["secureConnectionStart","Timestamp immediately before starting the handshake process"],["connectEnd","Timestamp immediately after establishing a connection to the server for document retrieval"],["requestStart","Timestamp immediately before requesting the current document"],["responseStart","Timestamp immediately after recieving the first byte of the current document"],["responseEnd","Timestamp immediately after recieving the last byte of the current document"],["domInteractive",'Timestamp immediately before the document readiness state is changed to "interactive"'],
["domContentLoadedEventStart","Timestamp immediately before the start of the DOMContentLoaded event"],["domContentLoadedEventEnd","Timestamp immediately after the end of the DOMContentLoaded event"],["domComplete",'Timestamp immediately before the document readiness state is changed to "complete"'],["loadEventStart","Timestamp immediately before the start of the load event"],["loadEventEnd","Timestamp immediately after the end of the load event"]],y=[["Page Load","Full length of page load","#01FB1B",
v,a.loadEventEnd],["Redirects","Time spent in redirects","#C8735A",a.redirectStart,a.redirectEnd],["Application Cache Check","Time spent looking into application caches for the document","#5F87EC",a.fetchStart,a.domainLookupStart!=a.fetchStart?a.domainLookupStart:a.connectStart!=a.fetchStart?a.connectStart:a.requestStart],["DNS Lookup","Time spent doing DNS lookup","#E41EEB",a.domainLookupStart,a.domainLookupEnd],["TCP Connection","Time spent in TCP connection","#D3CD23",a.connectStart,a.connectEnd],
["Secure TCP Connection","Time spent setting up Secure TCP connection","#24FDA4",a.secureConnectionStart,a.connectEnd],["Sending Request","Time spent sending request to server for document retrieval","#77C017",a.requestStart,a.responseStart],["Document Retrieval","Time spent from the first byte downloaded, till the last","#1BCA21",a.responseStart,a.responseEnd],["DOM Loading",'Time spent between "loading" and "complete" DOM Ready states',"#C51CDF",a.domLoading,a.domComplete],["DOM Interactive",'Time spent between "loading" and "interactive" DOM Ready states',
"#109596",a.domLoading,a.domInteractive],["DOM Ready Event","Time spent waiting for dom ready events to finish","#43A4EE",a.domContentLoadedEventStart,a.domContentLoadedEventEnd],["DOM Complete",'Time spent between end of DOMContentLoaded event and "complete" DOM REady state',"#E2845B",a.domContentLoadedEventEnd,a.domComplete],["On Load","Time spent waiting for the onload event to finish","#FF3300",a.loadEventStart,a.loadEventEnd]],N={markers:[["Previous Unload","Time spent in previous pages unload event (has to be same origin)",
"#A0C2A4",a.unloadEventStart,a.unloadEventEnd]],events:[["unloadEventStart","Timestamp immediately before the start of unload events on the previous document"],["unloadEventEnd","Timestamp immediately after the end of unload events on the previous document"],["domLoading",'Timestamp immediately before the document readiness state is changed to "loading"']]},i=u.document,P=u.console,n=function(b){P.info(b)},m=i.createElement("div"),w=i.createElement("div"),z=i.createElement("ul"),A=i.createElement("ul"),
G=i.createElement("ul"),B=i.createElement("div"),g=i.createElement("div"),l=i.createElement("div"),f=false,H=i.createElement("h1"),I=i.createElement("div"),J=i.createElement("div"),K=p.type==p.TYPE_NAVIGATE?"Link follow or entered in URL bar":p.type==p.TYPE_RELOAD?"Refresh":p.type==p.TYPE_BACK_FORWARD?"Back/Forward Button":p.type==p.TYPE_RESERVED?"Not defined by the browser":"God only knows",C={timing:{},events:{},nav:{how:K,redirects:p.redirectCount}},D=0,E=a.loadEventEnd-v;m.style.cssText='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;width:500px;padding:10px;position:absolute;z-index:100000;font-size:11px;top:25px;left:'+
(u.innerWidth/2-260-20)+"px;box-shadow: 0 0 15px black;border-radius:5px;border:1px solid #999;";w.style.cssText='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;background:#1F220E;position:relative;border-radius:5px;overflow:hidden;clear:both;';z.style.cssText='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;margin:10px 0 0;float:left;width:48%;padding-bottom:10px;';
A.style.cssText='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;margin:10px 0 0;float:left;width:51%;padding-bottom:10px;';G.style.cssText='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;margin:10px 0 0;clear:both;';
B.style.cssText='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;position:absolute;right:-7px;top:-7px;border-radius:10px;border:2px solid #f5f5f5;color:#f5f5f5;font-weight:bold;height:12px;width:12px;padding:1px 0 1px 1px;background:red;text-align:center;cursor:pointer;box-shadow: 0 0 3px black;';
g.style.cssText='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;position:absolute;border-left:1px solid #E0FA5D;top:0px;z-index:100001;display:none;';l.style.cssText='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;position:absolute;top:0px;z-index:100002;padding:3px 8px;font-weight:bold;font-size:11px;background:#E0FA5D;white-space:nowrap;display:none;';
w.appendChild(g);w.appendChild(l);H.style.cssText='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;font-size:21px;font-weight:bold;clear:both;margin-bottom:20px;';I.style.cssText='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;float:left;font-size:9px;';
J.style.cssText='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;float:right;font-size:9px;';H.innerHTML="Timing.js v0.1.0";I.innerHTML="Navigation Start (0ms)";J.innerHTML="Load Event End ("+E+"ms)";m.appendChild(H);m.appendChild(I);m.appendChild(J);m.appendChild(w);m.appendChild(z);
m.appendChild(A);m.appendChild(G);m.appendChild(B);i.body.appendChild(m);B.innerHTML="X";z.innerHTML="<li style='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:\"\" !important;font-weight:bold;font-size:18px;margin-bottom:4px;'>Timing Report</li>";A.innerHTML="<li style='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:\"\" !important;font-weight:bold;font-size:18px;margin-bottom:4px;'>Event Report</li>";
G.innerHTML="<li style='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:\"\" !important;font-weight:bold;font-size:18px;margin-bottom:4px;'>Navigation Report</li><li style='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:\"\" !important;padding:2px 0 4px 0;'>How you got here: <span style='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:\"\" !important;color:blue;'>"+
K+"</span></li><li style='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:\"\" !important;'>Number of Redirects: <span style='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:\"\" !important;color:blue;'>"+
p.redirectCount+"</span></li>";N.markers.forEach(function(b){var d=[],e=b[3],c=false;y.forEach(function(j,k){var h=y[k+1];d.push(j);if(!c&&e>=j[3]&&h&&e<h[3]){c=true;d.push(b)}});c||d.push(b);y=d.slice(0)});N.events.forEach(function(b){var d=[],e=a[b[0]],c=false;s.forEach(function(j,k){var h=s[k+1];d.push(j);if(!c&&e>=a[j[0]]&&h&&e<a[h[0]]){c=true;d.push(b)}});c||d.push(b);s=d.slice(0)});B.onclick=x;m.onclick=M;i.addEventListener("click",x,false);i.addEventListener("keyup",L,false);n("---Performance Timing Statistics---");
y.forEach(function(b){var d=b[0],e=b[1],c=b[2],j=b[3]||0;b=b[4]||0;var k=b-j,h=(j-v)/E*500,t=(b-v)/E*500-h,o=i.createElement("div"),q=i.createElement("li"),r=function(){o.style.backgroundColor="#E0FA5D";q.style.backgroundColor="#E0FA5D"},O=function(){o.style.backgroundColor=c;q.style.backgroundColor="transparent"};if(!(!j||!b||k<0)){C.timing[d]=k;if(t<5){t=5;if(h+t>500)h-=h+t-500}o.innerHTML=k+"ms: "+d;o.title=e;o.style.cssText='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;background:'+
c+";text-align:center;position:absolute;text-wrap:none;white-space:nowrap;line-height:20px;overflow:hidden;height:20px;font-size:13px;clear:both;border-radius:2px;top:"+D+"px;left:"+h+"px;width:"+t+"px;";q.innerHTML='<span style=\'margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;border:1px solid black;background:'+
c+";'>&nbsp;&nbsp;&nbsp;&nbsp;</span> "+d+": <span style='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:\"\" !important;color:blue;background:transparent;'>"+k+"ms</span>";q.title=e;q.style.cssText='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;padding:4px 0;';
o.addEventListener("mouseover",r,false);o.addEventListener("mouseout",O,false);q.addEventListener("mouseover",r,false);q.addEventListener("mouseout",O,false);w.appendChild(o);z.appendChild(q);n(d+" ("+e+"): "+k+"ms");if(k>0)D+=22;else o.style.display="none"}});(function(){var b=[],d=[],e=[];s.forEach(function(c){var j=c[0];C.events[j]=a[j];if(a[j])a[j]==v?d.push(c):e.push(c);else b.push(c)});s=b.concat(d,e)})();n("---Event Reporting---");s.forEach(function(b,d){var e=i.createElement("li"),c=b[0],
j=b[1],k=a[c]-v,h=((a[c]||0)-v)/E*500,t,o=function(){e.style.backgroundColor="#E0FA5D";if(a[c]&&f){if(f.pos!==h){g.style.display=l.style.display="block";g.style.width=Math.abs(h-f.pos)+"px";g.style.left=l.style.left=Math.min(h,f.pos)+"px";g.style.opacity=0.5;g.style.backgroundColor="#E0FA5D";l.innerHTML=k>f.time?k-f.time+"ms: "+f.name+"-"+c:f.time-k+"ms: "+c+" - "+f.name;t=d>f.i?s.slice(f.i,d+1):s.slice(d,f.i+1);t.forEach(function(r){if(r[2])r[2].style.backgroundColor="#E0FA5D"});if(f.pos/500>0.5){l.style.left=
"auto";l.style.right=500-Math.max(h,f.pos)+"px"}else{l.style.right="auto";l.style.left=Math.min(h,f.pos)+"px"}}}else if(a[c]){l.innerHTML=k+"ms - "+c;g.style.display=l.style.display="block";g.style.opacity=1;g.style.width="auto";g.style.backgroundColor="transparent";if(h/500>0.5){g.style.left=l.style.left="auto";g.style.right=l.style.right=500-h+"px";g.style.borderLeft="none";g.style.borderRight="1px solid #E0FA5D"}else{g.style.right=l.style.right="auto";g.style.left=l.style.left=h+"px";g.style.borderRight=
"none";g.style.borderLeft="1px solid #E0FA5D"}}},q=function(){e.style.backgroundColor="transparent";g.style.display=l.style.display="none";t=d>f.i?s.slice(f.i,d+1):s.slice(d,f.i+1);t.forEach(function(r){if(r[2])r[2].style.backgroundColor="transparent"})};e.setAttribute("data-name",c);b.push(e);e.style.cssText='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:"" !important;font-size:12px;'+
(a[c]?"cursor:pointer;":"");e.title=j;e.innerHTML=a[c]?k+"ms - "+c:"<span style='margin:0;padding:0;border:0;outline:0;font-weight:inherit;width:auto;font-style:inherit;font-size:13px;font-family:Times;text-align:left;vertical-align:baseline;color:inherit;line-height:13px;color:black;opacity:1;list-style:none;background:white;content:\"\" !important;font-style:italic;font-size:12px;background:transparent;'>Not Defined - "+c+"</span>";A.appendChild(e);e.addEventListener("click",function(r){if(a[c]&&
!f){f={i:d,pos:h,time:k,name:c};r.stopPropagation();r.preventDefault()}else{q();f=false;o()}},false);e.addEventListener("mouseover",o,false);e.addEventListener("mouseout",q,false);n("["+a[c]+"] "+c+" - "+j)});n("---Navigation Report---");n("How you got here: "+K);n("Number of Redriects: "+p.redirectCount);n("---Timing.js Report---");n(JSON.stringify(C));n(C);n("---Performance Object---");n(F);w.style.height=D+"px";g.style.height=D+"px";u.scrollTo(0,1)})(this);
